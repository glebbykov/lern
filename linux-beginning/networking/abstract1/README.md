# Конспект по сетям 1

## 1. Что такое сеть?
- **Сеть** — это группа устройств, соединённых между собой для обмена данными.

## 2. Порты
- **Порт** — логическая точка адресации приложения на устройстве.
- Наиболее распространённые порты:
  - HTTP: 80
  - HTTPS: 443
  - PostgreSQL (pg): 5432
  - MS SQL: 1433

## 3. Протоколы и взаимодействие
- При работе в виртуальной машине обычно используется **SSH** (Secure Shell) для удалённого подключения.
- **Глобальные сети** (VLAN) и **локальные сети** (Local) обеспечивают взаимодействие на различных уровнях.
- **Интерфейсы**:
  1. **Физические**: сетевая карта, Ethernet-кабель, Wi-Fi-адаптер.
  2. **Виртуальные**: эмулируются программно (например, `loopback` для взаимодействия приложений на одном устройстве).

## 4. Свойства интерфейсов
- **BROADCAST** — широковещательная передача.
- **NOARP** — интерфейс не будет использовать ARP для разрешения адресов.
- **MTU (Maximum Transmission Unit)**: 1500 байт по умолчанию — максимальный размер одного пакета.
- **qdisc** (queueing discipline) — тип управления очередями; `noop` — стандартная настройка.
- **state DOWN** — интерфейс неактивен на канальном уровне (L2), но может обрабатывать пакеты на уровне L3 (IP-уровне).
- **group default** — группа, к которой принадлежит сетевой интерфейс.
- **qlen (queue length) 1000** — длина очереди отправки/приёма пакетов.

## 5. MAC-адрес
- Каждое устройство имеет уникальный **MAC-адрес** (Layer 2).
- Пример MAC-адреса: `3a:5c:70:c0:91:4f`.
- Широковещательный (broadcast) MAC-адрес: `ff:ff:ff:ff:ff:ff`.

---

## 6. DHCP (Dynamic Host Configuration Protocol)

### 6.1. Основные понятия
- При первом подключении к сети клиент (DHCP Client) не знает свой IP-адрес.
- Клиент отправляет **DHCPDISCOVER** (широковещательный запрос) для поиска DHCP-сервера.
- Сервер, получив запрос, предлагает параметры (IP, маску, шлюз, DNS) в **DHCPOFFER**.
- Клиент отправляет **DHCPREQUEST**, подтверждая, что выбрал именно этот сервер.
- Сервер возвращает **DHCPACK** (подтверждение), клиент получает настройки и становится полноправным членом сети.

### 6.2. Отказ
- Если сервер не может выдать адрес (адрес занят, нет свободного места в пуле), он отправит **DHCPNAK**.
- Клиент в этом случае повторяет процесс заново и ищет другой сервер.

### 6.3. Аренда (Lease Time)
- IP-адрес выдаётся на ограниченный срок (lease time).
- По истечении половины срока (T1) клиент отправляет **DHCPREQUEST** на продление (DHCPRENEW).
- Если сервер недоступен, по достижении 67,5% времени (T2) делается широковещательный запрос.
- Если аренда полностью закончилась и не продлена, процедура DHCP начинается с нуля.

### 6.4. DHCPDECLINE (Отклонение)
- Если клиент обнаруживает, что адрес уже занят (через ARP), он отправляет **DHCPDECLINE**.
- Сервер помечает адрес как недоступный и предлагает клиенту новый адрес.

---

## 7. ARP (Address Resolution Protocol)

### 7.1. Назначение
- ARP сопоставляет IP-адрес (уровень 3) с MAC-адресом (уровень 2).
- Для отправки данных в локальной сети нужно знать MAC-адрес получателя.

### 7.2. Механизм работы
- **ARP Request** (широковещательный): «Кто имеет IP 192.168.1.20? Пришлите MAC».
- **ARP Reply** (уникаст): «192.168.1.20 имеет MAC 11:22:33:44:55:66».
- Результат сохраняется в ARP-таблицу.

### 7.3. Виды ARP
1. **Gratuitous ARP** — проверка собственного IP на предмет конфликтов (запрос «не занят ли мой IP?»).
2. **Proxy ARP** — ответ на ARP-запрос за другое устройство.
3. **Inverse ARP** — запрос IP-адреса, если известен MAC-адрес.

### 7.4. ARP Spoofing/Poisoning
- Вредоносная атака (Man-in-the-Middle), при которой искажаются записи в ARP-таблицах устройств с целью перехвата трафика.

---

## Полезные термины и заметки
- **SSH**: Протокол безопасного удалённого доступа к устройствам.
- **IP-адрес** (L3): Логический адрес, по которому устройство доступно в сети.
- **MAC-адрес** (L2): Физический (уникальный) адрес сетевой карты.
- **MTU**: Максимальный размер одного сетевого фрейма (кадра).
- **DHCP**: Протокол автоматической выдачи IP-адресов и сетевых параметров.
- **ARP**: Протокол разрешения IP-адресов в MAC-адреса.