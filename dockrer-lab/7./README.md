
# Лабораторная работа №7: Мониторинг и логирование в Docker

## Цели работы
1. Ознакомиться с инструментами мониторинга контейнеров в Docker.
2. Изучить возможности логирования Docker.
3. Освоить настройку драйверов логирования.
4. Научиться использовать внешние инструменты для анализа логов.

---

## 1. Теоретическая часть
### Мониторинг в Docker
- **Основные команды для мониторинга:**
  - `docker stats` — отображение ресурсов контейнеров.
  - `docker inspect` — просмотр детальной информации о контейнере.
  - `docker events` — мониторинг событий Docker.

### Логирование в Docker
- **По умолчанию Docker использует драйвер json-file.**
- **Основные драйверы логирования:**
  - `json-file` — хранение логов в формате JSON.
  - `syslog` — отправка логов в системный журнал.
  - `fluentd`, `gelf`, `awslogs`, `splunk` и другие.

### Настройка логирования
- Использование флага `--log-driver` для выбора драйвера.
- Настройка параметров драйвера через `--log-opt`.

---

## 2. Практическая часть
### Мониторинг контейнеров
1. Запустите тестовый контейнер на основе образа `nginx`:
    ```bash
    docker run -d --name nginx-monitor nginx
    ```

2. Проверьте использование ресурсов контейнеров:
    ```bash
    docker stats
    ```

3. Получите информацию о контейнере:
    ```bash
    docker inspect nginx-monitor
    ```

4. Подключите мониторинг событий Docker:
    ```bash
    docker events
    ```

### Работа с логами
1. Просмотрите логи запущенного контейнера:
    ```bash
    docker logs nginx-monitor
    ```

2. Перезапустите контейнер и проверьте добавление новых записей в логи.

### Настройка драйвера логирования
1. Запустите контейнер с использованием драйвера `syslog` (предварительно убедитесь, что syslog настроен на вашем хосте):
    ```bash
    docker run -d --name nginx-syslog --log-driver=syslog nginx
    ```

2. Проверьте, что логи отправляются в системный журнал.

### Внешний анализ логов
1. Установите Fluentd на хостовой машине.
2. Настройте контейнер для отправки логов в Fluentd:
    ```bash
    docker run -d --name nginx-fluentd --log-driver=fluentd nginx
    ```

3. Проверьте логи с помощью интерфейса Fluentd.

---

## 3. Теоретические вопросы
1. Какие команды используются для мониторинга ресурсов контейнеров?
2. Какие драйверы логирования поддерживает Docker?
3. В чем преимущества использования внешних систем логирования?
4. Как проверить параметры текущего драйвера логирования контейнера?
5. Какие события можно отслеживать с помощью команды `docker events`?

---

## 4. Дополнительные задания
1. **Настройка ограничения ресурсов:**
   - Запустите контейнер с ограничением использования CPU и памяти, и проверьте его поведение.

2. **Использование других драйверов логирования:**
   - Настройте контейнер для отправки логов в удаленный syslog-сервер.

3. **Интеграция с ELK:**
   - Настройте отправку логов контейнера в стек ELK (Elasticsearch, Logstash, Kibana).

4. **Сбор метрик:**
   - Используйте `Prometheus` для сбора метрик контейнеров.

