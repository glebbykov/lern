# 10. Operations и observability

## Цель
Настроить минимально достаточную наблюдаемость: метрики и контроль роста логов.

## Теория
- Без метрик и лог-ротации контейнерный стенд деградирует незаметно.
- Минимум: состояние контейнеров, ресурсные метрики, health endpoints.
- Логи должны иметь ограничение по размеру/количеству файлов.

## Практика
1. Поднимите стек наблюдаемости:
```bash
docker compose -f lab/compose.yaml up -d
```
2. Проверьте endpoints:
- App: `http://localhost:8085`
- cAdvisor: `http://localhost:8086`
- Prometheus: `http://localhost:9090`
3. Создайте нагрузку на app и проверьте метрики в Prometheus UI.

## Проверка
- Контейнеры доступны и отдают метрики/данные.
- Для app включена log rotation.
- Умеете объяснить, какие алерты базово нужны.

## Типовые ошибки
- Отсутствие лимитов логов.
- Неправильный target в `prometheus.yml`.
- Ориентация только на CPU без памяти/диска.

## Вопросы
1. Почему default `json-file` без ротации опасен?
2. Какие 3 метрики вы считаете базовыми для API?
3. Что нужно алертить в первую очередь?

## Дополнительные задания
- Добавьте alerting rules.
- Добавьте dashboard для контейнеров.

## Cleanup
```bash
./cleanup.sh
```
