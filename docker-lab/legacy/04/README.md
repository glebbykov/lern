
# Лабораторная работа №4: Docker Compose и управление многоконтейнерными приложениями

## Цели работы
1. Изучить основы работы с Docker Compose.
2. Создать многоконтейнерное приложение с использованием `docker-compose.yml`.
3. Понять назначение и работу сервисов, сетей и томов в Docker Compose.
4. Ознакомиться с командами для управления многоконтейнерными приложениями.

---

## 1. Теоретическая часть
### Что такое Docker Compose?
- Инструмент для управления многоконтейнерными приложениями.
- Позволяет описать приложение с помощью файла `docker-compose.yml`.

### Основные компоненты Docker Compose:
- **Сервисы**: отдельные контейнеры в приложении.
- **Сети**: для взаимодействия контейнеров.
- **Тома**: для хранения данных.

### Команды Docker Compose:
- `docker-compose up` — запуск приложения.
- `docker-compose down` — остановка и удаление ресурсов приложения.
- `docker-compose ps` — просмотр статуса контейнеров.
- `docker-compose logs` — просмотр логов контейнеров.

### Структура `docker-compose.yml`:
Пример минимального файла:
```yaml
version: '3.8'
services:
  web:
    image: nginx
    ports:
      - "8080:80"
  db:
    image: mysql
    environment:
      MYSQL_ROOT_PASSWORD: example
```

---

## 2. Практическая часть
### Создание многоконтейнерного приложения
1. Создайте директорию для проекта и перейдите в неё:
    ```bash
    mkdir docker-compose-app
    cd docker-compose-app
    ```

2. Создайте файл `docker-compose.yml`:
    ```yaml
    version: '3.8'
    services:
      web:
        image: nginx
        ports:
          - "8080:80"
      db:
        image: mysql:5.7
        environment:
          MYSQL_ROOT_PASSWORD: example
    ```

3. Запустите приложение:
    ```bash
    docker-compose up -d
    ```

4. Проверьте, что оба сервиса запущены:
    ```bash
    docker-compose ps
    ```

5. Остановите приложение и удалите созданные ресурсы:
    ```bash
    docker-compose down
    ```

### Добавление томов
1. Измените `docker-compose.yml`, чтобы добавить том для базы данных:
    ```yaml
    version: '3.8'
    services:
      web:
        image: nginx
        ports:
          - "8080:80"
      db:
        image: mysql:5.7
        environment:
          MYSQL_ROOT_PASSWORD: example
        volumes:
          - db-data:/var/lib/mysql
    volumes:
      db-data:
    ```

2. Запустите приложение и убедитесь, что том создан:
    ```bash
    docker-compose up -d
    docker volume ls
    ```

3. Проверьте сохранность данных после перезапуска контейнера.

### Работа с логами и сетями
1. Просмотрите логи всех контейнеров:
    ```bash
    docker-compose logs
    ```

2. Проверьте созданные сети:
    ```bash
    docker network ls
    ```

3. Убедитесь, что контейнеры могут взаимодействовать друг с другом через сеть.

---

## 3. Теоретические вопросы
1. Какие преимущества использования Docker Compose перед отдельным управлением контейнерами?
2. Для чего используются тома в Docker Compose?
3. Что произойдет с томами после выполнения команды `docker-compose down`?
4. Как подключить контейнер к пользовательской сети через Docker Compose?
5. Чем отличаются команды `up` и `start` в Docker Compose?

---

## 4. Дополнительные задания
1. **Добавление сервиса:**
   - Добавьте сервис с веб-приложением на базе `python:3.9` и настройте его для запуска простого HTTP-сервера.

2. **Настройка сетей:**
   - Разделите сервисы `web` и `db` по разным пользовательским сетям и настройте их взаимодействие.

3. **Обновление образов:**
   - Добавьте флаг `build` в сервис `web`, чтобы Docker Compose автоматически пересобирал образ.

4. **Ограничение ресурсов:**
   - Настройте ограничения по CPU и памяти для одного из сервисов.
